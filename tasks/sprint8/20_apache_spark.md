## Обработка датасета в Spark

Скачайте с kaggle.com [датасет с информацией о мороженом](https://www.kaggle.com/tysonpo/ice-cream-dataset).
В датасете с мороженым есть пять папок: bj, breyers, hd, talenti, combined. Первые четыре папки — с брендами мороженого, папка combined содержит информацию о нескольких брендах. Все папки имеют одинаковую структуру: images, products.csv, reviews.csv.

Задача — выстроить рейтинг мороженого по его отзывам. 

Задача 1

Текущая формула учитывает только оценку и сглаживается количеством оценок. Но оценки могут быть и накручены ботами. Чтобы сгладить влияние накрутки, можно воспользоваться колонками helpful_yes и helpful_no. В этих колонках содержится информация о количестве людей, посчитавших отзыв полезным и наоборот.

Подсказка. Можно учитывать полезность отзыва, добавив к его оценке вес — коэффициент, на который умножается число. Он служит для оценки полезности этого числа в общем расчёте.
Например, рассчитать вес для отзыва можно так:

    ```
    def calculate_weight(helpful_yes, helpful_no):
        return helpful_yes / (helpful_yes + helpful_no)
    ```
И умножать этот вес нужно на рейтинг отзыва. Если отзыв всем не помог, то вес будет 0, а если очень полезный, то оценка будет учтена в полной мере.

Задача 2

Добавьте в файл products.csv ещё одну колонку rating_by_reviews, которую заполните посчитанными данными. В файле products.csv уже есть рейтинг. Сравните рейтинг с тем, что получился у вас. Какие выводы можно сделать, сравнив ваш рейтинг и уже посчитанный? Не забудьте сохранить новую версию файла после добавления данных.
Подсказка. Для объединения двух RDD (products.csv и RDD с рассчитанным рейтингом) можно воспользоваться функциями:

```
join и её вариациями;
union;
```

При сохранении нового файла не забудьте привести каждую строку в тот формат, в котором она была изначально.

Оценка