## Аггрегирование данных

Данные о лайках и отзывах пользователя поступают потоком из кафки в монго. Для получения информации по общему количеству лайков для фильма или для отзыва можно либо каждый раз делать запрос с аггрегацией данных, либо периодически проводить аггрегацию в фоне.

Если вреямя получение общего количества лайков/дизлайков для фильма окажется выше 200мс, нужно будет написать ETL для аггрегации данных по лайкам в фоновом режиме.

Как пример:
- Исходный документ
    {
        user_id: uuid,
        movie_id: uuid,
        like: bool or null
    }

- После аггрегирования
    {
        movie_id: uuid,
        like: int,
        dislike: int
    }

Какие документы приходят в монго и уходят из него взять из задачи 10_bigdata_api

Примечание:
- процесс должен запускаться периодически, например 1 раз в минуту

Оценка 8
